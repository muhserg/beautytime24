//https://www.jqueryscript.net/form/jQuery-Plugin-For-Multiple-Select-With-Checkboxes-multi-select-js.html
!function(o){"use strict";var n="multiSelect",s={containerHTML:'<div class="multi-select-container">',menuHTML:'<div class="multi-select-menu">',buttonHTML:'<span class="multi-select-button">',menuItemsHTML:'<div class="multi-select-menuitems">',menuItemHTML:'<label class="multi-select-menuitem">',presetsHTML:'<div class="multi-select-presets">',activeClass:"multi-select-container--open",noneText:"-- Select --",allText:void 0,presets:void 0,positionedMenuClass:"multi-select-container--positioned",positionMenuWithin:void 0,viewportBottomGutter:20,menuMinHeight:200};function e(t,e){this.element=t,this.$element=o(t),this.settings=o.extend({},s,e),this._defaults=s,this._name=n,this.init()}o.extend(e.prototype,{init:function(){this.checkSuitableInput(),this.findLabels(),this.constructContainer(),this.constructButton(),this.constructMenu(),this.setUpBodyClickListener(),this.setUpLabelsClickListener(),this.$element.hide()},checkSuitableInput:function(t){if(!1===this.$element.is("select[multiple]"))throw new Error("$.multiSelect only works on <select multiple> elements")},findLabels:function(){this.$labels=o('label[for="'+this.$element.attr("id")+'"]')},constructContainer:function(){this.$container=o(this.settings.containerHTML),this.$element.data("multi-select-container",this.$container),this.$container.insertAfter(this.$element)},constructButton:function(){var n=this;this.$button=o(this.settings.buttonHTML),this.$button.attr({role:"button","aria-haspopup":"true",tabindex:0,"aria-label":this.$labels.eq(0).text()}).on("keydown.multiselect",function(t){var e=t.which;13!==e&&32!==e||n.$button.click()}).on("click.multiselect",function(t){n.menuToggle()}).appendTo(this.$container),this.$element.on("change.multiselect",function(){n.updateButtonContents()}),this.updateButtonContents()},updateButtonContents:function(){var e=[],n=[];this.$element.children("option").each(function(){var t=o(this).text();e.push(t),o(this).is(":selected")&&n.push(o.trim(t))}),this.$button.empty(),0==n.length?this.$button.text(this.settings.noneText):n.length===e.length&&this.settings.allText?this.$button.text(this.settings.allText):this.$button.text(n.join(", "))},constructMenu:function(){var e=this;this.$menu=o(this.settings.menuHTML),this.$menu.attr({role:"menu"}).on("keyup.multiselect",function(t){27===t.which&&e.menuHide()}).appendTo(this.$container),this.constructMenuItems(),this.settings.presets&&this.constructPresets()},constructMenuItems:function(){var n=this;this.$menuItems=o(this.settings.menuItemsHTML),this.$menu.append(this.$menuItems),this.$element.on("change.multiselect",function(t,e){!0!==e&&n.updateMenuItems()}),this.updateMenuItems()},updateMenuItems:function(){var s=this;this.$menuItems.empty(),this.$element.children("option").each(function(t,e){var n=s.constructMenuItem(o(e),t);s.$menuItems.append(n)})},constructPresets:function(){var i=this;this.$presets=o(this.settings.presetsHTML),this.$menu.prepend(this.$presets),o.each(this.settings.presets,function(t,e){var n=i.$element.attr("id")+"_preset_"+t,s=o(i.settings.menuItemHTML).attr({for:n,role:"menuitem"}).text(" "+e.name).appendTo(i.$presets);o("<input>").attr({type:"radio",name:i.$element.attr("id")+"_presets",id:n}).prependTo(s).on("change.multiselect",function(){i.$element.val(e.options),i.$element.trigger("change")})}),this.$element.on("change.multiselect",function(){i.updatePresets()}),this.updatePresets()},updatePresets:function(){var i=this;o.each(this.settings.presets,function(t,e){var n=i.$element.attr("id")+"_preset_"+t,s=i.$presets.find("#"+n);!function(t,e){if(t.length!=e.length)return!1;t.sort(),e.sort();for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(e.options||[],i.$element.val()||[])?s.prop("checked",!1):s.prop("checked",!0)})},constructMenuItem:function(t,e){var n=this.$element.attr("id")+"_"+e,s=o(this.settings.menuItemHTML).attr({for:n,role:"menuitem"}).text(" "+t.text()),i=o("<input>").attr({type:"checkbox",id:n,value:t.val()}).prependTo(s);return t.is(":disabled")&&i.attr("disabled","disabled"),t.is(":selected")&&i.prop("checked","checked"),i.on("change.multiselect",function(){o(this).prop("checked")?t.prop("selected",!0):t.prop("selected",!1),t.trigger("change",[!0])}),s},setUpBodyClickListener:function(){var t=this;o("html").on("click.multiselect",function(){t.menuHide()}),this.$container.on("click.multiselect",function(t){t.stopPropagation()})},setUpLabelsClickListener:function(){var e=this;this.$labels.on("click.multiselect",function(t){t.preventDefault(),t.stopPropagation(),e.menuToggle()})},menuShow:function(){if(o("html").trigger("click.multiselect"),this.$container.addClass(this.settings.activeClass),this.settings.positionMenuWithin&&this.settings.positionMenuWithin instanceof o){var t=this.$menu.offset().left+this.$menu.outerWidth(),e=this.settings.positionMenuWithin.offset().left+this.settings.positionMenuWithin.outerWidth();e<t&&(this.$menu.css("width",e-this.$menu.offset().left),this.$container.addClass(this.settings.positionedMenuClass))}var n=this.$menu.offset().top+this.$menu.outerHeight(),s=o(window).scrollTop()+o(window).height();n>s-this.settings.viewportBottomGutter?this.$menu.css({maxHeight:Math.max(s-this.settings.viewportBottomGutter-this.$menu.offset().top,this.settings.menuMinHeight),overflow:"scroll"}):this.$menu.css({maxHeight:"",overflow:""})},menuHide:function(){this.$container.removeClass(this.settings.activeClass),this.$container.removeClass(this.settings.positionedMenuClass),this.$menu.css("width","auto")},menuToggle:function(){this.$container.hasClass(this.settings.activeClass)?this.menuHide():this.menuShow()}}),o.fn[n]=function(t){return this.each(function(){o.data(this,"plugin_"+n)||o.data(this,"plugin_"+n,new e(this,t))})}}(jQuery);